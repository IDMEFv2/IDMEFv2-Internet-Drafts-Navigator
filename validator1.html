<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252"><meta name="viewport" content="width=device-width"><title>https://secef.net/idmef-validator/idmefv2_validator.html</title><link rel="stylesheet" type="text/css" href="resource://content-accessible/viewsource.css"></head><body id="viewsource" class="highlight" style="tab-size: 4"><pre id="line1"><span></span><span class="error" title="Balise ouvrante rencontrée sans avoir rencontré de doctype auparavant. «&nbsp;&lt;!DOCTYPE html&gt;&nbsp;» attendu.">&lt;<span class="start-tag">html</span>&gt;</span><span>
<span id="line2"></span></span><span>&lt;<span class="start-tag">head</span>&gt;</span><span>
<span id="line3"></span>    </span><span>&lt;<span class="start-tag">title</span>&gt;</span><span>IDMEFv2 - JSON Validator - Version 0.3</span><span>&lt;/<span class="end-tag">title</span>&gt;</span><span>
<span id="line4"></span></span><span>&lt;/<span class="end-tag">head</span>&gt;</span><span>
<span id="line5"></span></span><span>&lt;<span class="start-tag">body</span>&gt;</span><span>
<span id="line6"></span></span><span>&lt;<span class="start-tag">h1</span>&gt;</span><span>IDMEFv2 - JSON Validator - Version 0.3</span><span>&lt;/<span class="end-tag">h1</span>&gt;</span><span>
<span id="line7"></span></span><span>&lt;<span class="start-tag">table</span> <span class="attribute-name">width</span>="<a class="attribute-value">100%</a>" <span class="attribute-name">style</span>="<a class="attribute-value">border-collapse:collapse</a>"&gt;</span><span>
<span id="line8"></span>    </span><span>&lt;<span class="start-tag">tr</span> <span class="attribute-name">style</span>="<a class="attribute-value">border-bottom: 1px solid black;</a>"&gt;</span><span>
<span id="line9"></span>        </span><span>&lt;<span class="start-tag">td</span> <span class="attribute-name">width</span>="<a class="attribute-value">60%</a>"&gt;</span><span>
<span id="line10"></span>            </span><span>&lt;<span class="start-tag">label</span> <span class="attribute-name">for</span>="<a class="attribute-value">idmefv2_text</a>"&gt;</span><span>Paste an IDMEFv2 message:</span><span>&lt;/<span class="end-tag">label</span>&gt;</span><span>
<span id="line11"></span>            </span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span></span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span>
<span id="line12"></span>            </span><span>&lt;<span class="start-tag">textarea</span> <span class="attribute-name">style</span>="<a class="attribute-value">width:100%</a>" <span class="attribute-name">rows</span>="<a class="attribute-value">20</a>" <span class="attribute-name">id</span>="<a class="attribute-value">idmefv2_text</a>" <span class="attribute-name">name</span>="<a class="attribute-value">idmefv2_text</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">textarea</span>&gt;</span><span>
<span id="line13"></span>            </span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span>
<span id="line14"></span>            </span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span>
<span id="line15"></span>            </span><span>&lt;<span class="start-tag">input</span> <span class="attribute-name">type</span>="<a class="attribute-value">button</a>" <span class="attribute-name">value</span>="<a class="attribute-value">Validate</a>" <span class="attribute-name">onclick</span>="<a class="attribute-value">validate_text()</a>"<span>/</span>&gt;</span><span>
<span id="line16"></span>            </span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span>
<span id="line17"></span>            </span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span>
<span id="line18"></span>        </span><span>&lt;/<span class="end-tag">td</span>&gt;</span><span>
<span id="line19"></span>        </span><span>&lt;<span class="start-tag">td</span>&gt;</span><span>
<span id="line20"></span>            </span><span>&lt;<span class="start-tag">p</span> <span class="attribute-name">id</span>="<a class="attribute-value">idmefv2_text_result</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line21"></span>        </span><span>&lt;/<span class="end-tag">td</span>&gt;</span><span>
<span id="line22"></span>    </span><span>&lt;/<span class="end-tag">tr</span>&gt;</span><span>
<span id="line23"></span>    </span><span>&lt;<span class="start-tag">tr</span>&gt;</span><span>
<span id="line24"></span>        </span><span>&lt;<span class="start-tag">td</span> <span class="attribute-name">width</span>="<a class="attribute-value">60%</a>"&gt;</span><span>
<span id="line25"></span>            </span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span>
<span id="line26"></span>            </span><span>&lt;<span class="start-tag">label</span> <span class="attribute-name error error" title="Guillemet dans un nom d’attribut. Cause probable&nbsp;: guillemet correspondant manquant précédemment dans le code.
Guillemet dans un nom d’attribut. Cause probable&nbsp;: guillemet correspondant manquant précédemment dans le code.">for"idmefv2_file"</span>&gt;</span><span>Or upload a file containing an IDMEFv2 message:</span><span>&lt;/<span class="end-tag">label</span>&gt;</span><span>
<span id="line27"></span>            </span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span></span><span>&lt;<span class="start-tag">br</span> <span>/</span>&gt;</span><span>
<span id="line28"></span>            </span><span>&lt;<span class="start-tag">input</span> <span class="attribute-name">id</span>="<a class="attribute-value">idmefv2_file</a>" <span class="attribute-name">type</span>="<a class="attribute-value">file</a>" <span class="attribute-name">name</span>="<a class="attribute-value">idmefv2_file</a>" <span>/</span>&gt;</span><span>
<span id="line29"></span>        </span><span>&lt;/<span class="end-tag">td</span>&gt;</span><span>
<span id="line30"></span>        </span><span>&lt;<span class="start-tag">td</span>&gt;</span><span>
<span id="line31"></span>            </span><span>&lt;<span class="start-tag">p</span> <span class="attribute-name">id</span>="<a class="attribute-value">idmefv2_file_result</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">p</span>&gt;</span><span>
<span id="line32"></span>        </span><span>&lt;/<span class="end-tag">td</span>&gt;</span><span>
<span id="line33"></span>    </span><span>&lt;/<span class="end-tag">tr</span>&gt;</span><span>
<span id="line34"></span></span><span>&lt;/<span class="end-tag">table</span>&gt;</span><span>
<span id="line35"></span></span><span>&lt;<span class="start-tag">script</span> <span class="attribute-name">src</span>="<a class="attribute-value" href="view-source:https://cdnjs.cloudflare.com/ajax/libs/ajv/6.12.6/ajv.min.js">https://cdnjs.cloudflare.com/ajax/libs/ajv/6.12.6/ajv.min.js</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">script</span>&gt;</span><span>
<span id="line36"></span></span><span>&lt;<span class="start-tag">script</span> <span class="attribute-name">src</span>="<a class="attribute-value" href="view-source:https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js</a>"&gt;</span><span></span><span>&lt;/<span class="end-tag">script</span>&gt;</span><span>
<span id="line37"></span></span><span>&lt;<span class="start-tag">script</span>&gt;</span><span>
<span id="line38"></span>var ajv_validate;
<span id="line39"></span>$.getJSON('https://raw.githubusercontent.com/json-schema-org/json-schema-spec/draft-04/schema.json', function (metaschema) {
<span id="line40"></span>    $.getJSON('https://raw.githubusercontent.com/SECEF/idmefv2-definition/main/IDMEFv2.schema', function (schema) {
<span id="line41"></span>        var ajv = new Ajv({schemaId: 'id', allErrors: true});
<span id="line42"></span>        ajv.addMetaSchema(metaschema);
<span id="line43"></span>        ajv_validate = ajv.compile(schema);
<span id="line44"></span>    });
<span id="line45"></span>});
<span id="line46"></span>
<span id="line47"></span>function validate(data, target) {
<span id="line48"></span>    $(target).empty();
<span id="line49"></span>    if (data) {
<span id="line50"></span>        try {
<span id="line51"></span>            valid = ajv_validate(JSON.parse(data));
<span id="line52"></span>        } catch(e) {
<span id="line53"></span>            $(target).append("Error while reading the JSON: " + e);
<span id="line54"></span>            return;
<span id="line55"></span>        }
<span id="line56"></span>        if (!valid) {
<span id="line57"></span>            ajv_validate.errors.forEach(function(err) {
<span id="line58"></span>                console.log(err);
<span id="line59"></span>                if ( err["dataPath"] )
<span id="line60"></span>                    var path = err["dataPath"].substr(1);
<span id="line61"></span>                else
<span id="line62"></span>                    var path = "Root";
<span id="line63"></span>                if (err["keyword"] == "additionalProperties")
<span id="line64"></span>                    path = path + "." + err["params"]["additionalProperty"];
<span id="line65"></span>                $(target).append("Path: " + path + ", Error: " + err["message"] + "</span><span>&lt;b</span><span>r /&gt;"); 
<span id="line66"></span>            });
<span id="line67"></span>        } else {
<span id="line68"></span>            $(target).append("</span><span>&lt;p</span><span> style=\"text-align: center\"&gt;No errors</span><span>&lt;/<span></span>p</span><span>&gt;");
<span id="line69"></span>        }
<span id="line70"></span>    }
<span id="line71"></span>}
<span id="line72"></span>
<span id="line73"></span>function validate_text() {
<span id="line74"></span>    validate($("#idmefv2_text")[0].value, "#idmefv2_text_result");
<span id="line75"></span>} 
<span id="line76"></span>
<span id="line77"></span>$("#idmefv2_file").on('change', function(event) {
<span id="line78"></span>    var target = "#idmefv2_file_result";
<span id="line79"></span>    $(target).empty();
<span id="line80"></span>    var file = event.target.files[0];
<span id="line81"></span>    if (!file.type) {
<span id="line82"></span>        $(target).append("Error: The File.type property does not appear to be supported on this browser.");
<span id="line83"></span>        return;
<span id="line84"></span>    }
<span id="line85"></span>    if (!file.type.match('application.json')) {
<span id="line86"></span>        $(target).append("Error: The selected file does not appear to be an image.");
<span id="line87"></span>        return;
<span id="line88"></span>    }
<span id="line89"></span>    const reader = new FileReader();
<span id="line90"></span>    reader.addEventListener('load', event =&gt; {
<span id="line91"></span>        validate( event.target.result, "#idmefv2_file_result");
<span id="line92"></span>    });
<span id="line93"></span>    reader.readAsText(file);
<span id="line94"></span>});
<span id="line95"></span></span><span>&lt;/<span class="end-tag">script</span>&gt;</span><span>
<span id="line96"></span></span><span>&lt;/<span class="end-tag">body</span>&gt;</span><span>
<span id="line97"></span></span><span>&lt;/<span class="end-tag">html</span>&gt;</span><span>
<span id="line98"></span></span></pre></body></html>